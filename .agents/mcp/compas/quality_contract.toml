# Compas Sentinel v1 â€” quality policy contract

[quality]
min_trust_score = 40
allow_trust_drop = false
allow_coverage_drop = false
max_weighted_risk_increase = 0

[exceptions]
max_exceptions = 10
max_suppressed_ratio = 0.30
max_exception_window_days = 90

[receipt_defaults]
min_duration_ms = 500
min_stdout_bytes = 10

[governance]
mandatory_checks = [
  "boundary",
  "supply_chain",
  "loc",
  "tool_budget",
  "reuse_first",
  "arch_layers",
  "complexity_budget",
  "contract_break",
]
mandatory_failure_modes = ["security_baseline", "resilience_defaults"]
min_failure_modes = 8

[proof]
require_witness = true

[baseline]
snapshot_path = ".agents/mcp/compas/baselines/quality_snapshot.json"
max_scope_narrowing = 0.10

[impact]
diff_base = "merge-base:origin/main"
unmapped_path_policy = "observe"

[[impact.rules]]
id = "p13-secrets-scan"
path_globs = [
  "tools/custom/secrets-scan/tool.toml",
  "scripts/p13_secrets_scan.py",
  ".agents/mcp/compas/plugins/p13/plugin.toml",
]
required_tools = ["secrets-scan"]

[[impact.rules]]
id = "runtime-rust"
path_globs = ["crates/ai-dx-mcp/src/**/*.rs", "crates/ai-dx-mcp/tests/**/*.rs"]
required_tools = ["cargo-test", "cargo-test-lite", "tests-junit"]

[[impact.rules]]
id = "runtime-rust-tests"
path_globs = ["crates/ai-dx-mcp/tests/**/*.rs"]
required_tools = ["cargo-test"]

[[impact.rules]]
id = "docs-and-arch"
path_globs = [
  "AGENTS.md",
  "ARCHITECTURE.md",
  "README.md",
  "docs/**/*.md",
  "scripts/docs_sync.py",
]
required_tools = ["docs-sync-check", "lint-unified"]

[[impact.rules]]
id = "p19-unified-lint"
path_globs = [
  ".agents/mcp/compas/plugins/**/*",
  ".agents/mcp/compas/quality_contract.toml",
  "tools/custom/lint-unified/**/*",
]
required_tools = ["lint-unified"]

[[impact.rules]]
id = "spec-adr-gate"
path_globs = [
  "docs/spec/**",
  "docs/adr/**",
]
required_tools = ["spec-check"]

[[impact.rules]]
id = "compas-policy"
path_globs = [
  ".agents/mcp/compas/**/*.toml",
  "tools/custom/**/*.toml",
  "tools/custom/tests-junit/run_tests_junit.py",
]
required_tools = ["docs-sync-check", "cargo-test"]

[[impact.rules]]
id = "dependency-manifests"
path_globs = [
  "Cargo.toml",
  "Cargo.lock",
  "package.json",
  "package-lock.json",
  "pnpm-lock.yaml",
  "yarn.lock",
  "npm-shrinkwrap.json",
  "requirements.txt",
  "requirements-dev.txt",
  "pyproject.toml",
  "poetry.lock",
  "Pipfile",
  "Pipfile.lock",
  "go.mod",
  "go.sum",
  "go.work",
  "go.work.sum",
  "gradle.properties",
  "pom.xml",
  "build.gradle",
  "build.gradle.kts",
  "Gemfile",
  "Gemfile.lock",
  "composer.json",
  "composer.lock",
  "mix.exs",
  "mix.lock",
  "packages.config",
  "project.assets.json",
]
required_tools = ["sbom"]

[[impact.rules]]
id = "sbom-tooling"
path_globs = ["tools/custom/sbom/**/*.py"]
required_tools = ["sbom"]
